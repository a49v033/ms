<html xmlns:th="http://www.thymeleaf.org">
<head>
<title></title>
</head>
<body>
<div id="msg"></div>
<script lang="javascript" type="text/javascript">
	var clientId = "[[${app.getAppId()}]]";
	var clientPwd = "[[${app.getAppPwd()}]]";
	var uri = "[[${app.getRedirectUri()}]]";
	
	var accessToken = "[[${access_token}]]";
	var refreshToken = "[[${refresh_token}]]";
	
	if( !!accessToken && !!refreshToken ){
		document.getElementById('msg').innerHTML+='<b>AccessToken:</b><div><textarea rows="18" cols="160" >'+accessToken+'</textarea></div>';
		document.getElementById('msg').innerHTML+='<b>RefreshToken:</b><div><textarea rows="10" cols="160" >'+refreshToken+'</textarea></div>';
		document.getElementById('msg').innerHTML+='<form action="/getNewToken" id="f1"><input type="hidden" name="refresh_token" id="refresh_token" value='+refreshToken+' /><input type="button" value="Get new one" onclick="getNewToken();" /></form>';
	}
	else {
		document.getElementById('msg').innerHTML='<b>Pls wait...</b>';
		window.location.href = "https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id="+clientId+"&response_type=code&scope=Files.ReadWrite.All%20offline_access&redirect_uri="+uri;
	}
	
	function getNewToken(){
		document.getElementById("f1").submit();
	}
</script>

</body>
</html>
